<h2 align="center">IoT PS4 Telemetry Display - 2019 (C++, ESP8266)</h2>
<h3>Planning</h3>
<p>Inspired by steering wheels in Formula 1, I wanted to create a mod for my Logitech G29 gaming wheel which added an onboard display. This display should show useful data such as tyre wear, tyre temperature, and estimated fuel usage during a race in the game F1 2018 on my PS4.</p>
<h4>Gathering Telemetry Data</h4>
<p>Codemasters' F1 series of games, as well as many other racing simulators and arcades, have an option to broadcast telemetry. This sends UDP data packets containing information about the session, lap, car and other drivers to any local IP address of one's choosing. Alternatively, it can broadcast this data to all devices through the subnet mask.
The data is sent in the form of a header which specifies the type of packet alongside the rest of the packet's data. I could receive this data by using a packed struct in C++ and reading 
the exact number of bytes in the packet into the associated struct I had created.</p>
<h4>Receiving Telemetry Data</h4>
<p>Since the device needs to have a relatively small form factor in order to fit on the steering wheel, the usual options such as a Rasberry Pi, or even a Pi Zero were unrealistic.
Instead, I chose to use an ESP8266 microcontroller on a Wemos D1 Mini board. This is both more powerful than a typical ATMega328P (so can drive a display at an acceptable refresh rate)
and has onboard WiFi in order to receive the data packets. This is far more convenient and space-saving than using an addon for WiFI with an alternative board.</p>
<h4>Displaying Telemetry Data</h4>
<p>The G29 does not have large wheel and only has a small area of open space that could fit a display. For this reason, I opted for a 3.2 inch LCD panel which uses an SPI interface. The 
SPI interface ensures it is easy to connect and use with the ESP8266. The panel interfaces with the ILI9341 driver which has a well-maintained library for my device.</p>
<h3>Designing</h3>
<p>My initial idea for the logic of the system was simple - a microcontroller connected to a display. However, on further contemplation, it became obvious that this was an oversimplification.
Powering the device was a serious consideration since when the wheel was turned, any connected wire would tangle (especially since the G29 has a maximum of 900 degrees of rotation).
The simplest solution to this was to make the device battery powered. Lithium Ion was, in my opinion, the best option here because of the low discharge and degredation alongside
a high energy density. Further to this, Lithium Polymer was a much more expensive option considering the cost per unit capacity. The batteries can simply be charged
while the wheel is not in use with a cable.</p>
<p>With the feasibility considerations made, I knew exactly what parts I'd need for the project:
<ul>
	<li>Wemos D1 Mini</li>
	<li>3.2" SPI TFT Display</li>
	<li>2x 18650 9600mAh Batteries</li>
	<li>18650 Charging Shield</li>
	<li>Voltage Regulator (for 5v supply to D1 Mini)</li>
	<li>SPST Toggle Switch</li>
</ul>
</p>
<p>Additionally, the next challenge was connecting all of this together in a permanent way. The best option was a custom printed circuit board. So, I set about designing
a compact PCB that could fit everything but the battery shield under the space encompassed by the display</p>
<h4 align="center">A quick and dirty schematic</h4>
<img class="center" src="{{ url_for('static',filename='files/telemetry-schematic.svg') }}"></img>
<h4 align="center">PCB Design</h4>
<h5 align="center">Merged Layers</h5>
<img class="center" src="{{ url_for('static',filename='files/Telem_All_Layers.svg') }}" width="75%"></img>
<h5 align="center">Top Layer</h5>
<img class="center" src="{{ url_for('static',filename='files/Telem_Top_Layer.svg') }}" width="75%"></img>
<h5 align="center">Bottom Layer</h5>
<img class="center" src="{{ url_for('static',filename='files/Telem_Bottom_Layer.svg') }}" width="75%"></img>
<p>The final consideration that needed to be made was how it would be mounted to the wheel. The G29 comes with a cap that secures the steering wheel in place using six hex screws. I thought this
would be a good position to mount a thick, rectangular plate which could hold the PCB, display and battery shield. I first designed a replacement cap which could mount a plate above it using four
standard M3 self-tapping screws.</p>
<iframe class="center" src="{{ url_for('static',filename='files/Telem_G29_Cap.html') }}" scrolling="no" height="500"></iframe>
